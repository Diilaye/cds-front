"use strict";(self.webpackChunkcds_front=self.webpackChunkcds_front||[]).push([[425],{5425:(z,m,l)=>{l.r(m),l.d(m,{MessageModule:()=>H});var c=l(6895),d=l(646),e=l(1571);let f=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-message"]],decls:1,vars:0,template:function(s,o){1&s&&e._UZ(0,"router-outlet")},dependencies:[d.lC]})}return n})();var g=l(6199);function _(n,a){if(1&n&&(e.TgZ(0,"tr",11)(1,"td",12),e._uU(2),e.qZA(),e.TgZ(3,"td",13),e._uU(4),e.qZA(),e.TgZ(5,"td",14),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"span",15),e._uU(11),e.qZA()(),e.TgZ(12,"td",16)(13,"button",17),e._UZ(14,"i",18),e.qZA(),e.TgZ(15,"a",19),e._UZ(16,"i",20),e.qZA()()()),2&n){const t=a.$implicit,s=a.index;e.xp6(2),e.hij("",s+1," "),e.xp6(2),e.Oqu(t.objectEmail),e.xp6(2),e.Oqu(t.message),e.xp6(2),e.AsE("",t.send.prenom," ",t.send.nom,""),e.xp6(3),e.Oqu(t.status)}}function b(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"table",8)(2,"thead")(3,"tr")(4,"th",9),e._uU(5,"#"),e.qZA(),e.TgZ(6,"th",9),e._uU(7,"Objet"),e.qZA(),e.TgZ(8,"th",9),e._uU(9,"Message"),e.qZA(),e.TgZ(10,"th",9),e._uU(11,"Recive"),e.qZA(),e.TgZ(12,"th",9),e._uU(13,"Status"),e.qZA(),e.TgZ(14,"th",9),e._uU(15,"Actions"),e.qZA()()(),e.TgZ(16,"tbody"),e.YNc(17,_,17,6,"tr",10),e.qZA()()()),2&n){const t=e.oxw();e.xp6(17),e.Q6J("ngForOf",t.data)}}function v(n,a){1&n&&(e.TgZ(0,"div",21)(1,"div",22)(2,"span",23),e._uU(3,"Loading..."),e.qZA()()())}let h=(()=>{class n{constructor(t){this.messageService=t,this.data=[]}ngOnInit(){this.getMessages()}getMessages(){this.messageService.all().subscribe({next:t=>{console.log("data message ",t),this.data=t.data.sort((s,o)=>s.id-o.id)},error:t=>{console.log("error ",t)}})}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(g.e))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-list"]],decls:11,vars:2,consts:[[1,"container-fluid","mybg-color","pb-5","mt-5","pt-5"],[1,"d-flex","justify-content-between","align-items-center"],["type","button","routerLink","/message/add",1,"btn","btn-warning","rounded-pill"],["aria-hidden","true",1,"fa","fa-add"],[1,"container","pl-2","pr-2","pb-2","shadow","rounded-5",2,"max-height","500px","overflow-y","auto"],["class","table-responsive",4,"ngIf","ngIfElse"],["placeholder",""],[1,"table-responsive"],[1,"table","table-white","table-border-0","no-border"],["scope","col"],["class","",4,"ngFor","ngForOf"],[1,""],["scope","row"],[1,"text-truncate",2,"max-width","10px"],[1,"text-truncate",2,"max-width","20px"],[1,"badge","bg-primary"],[1,"gap-1","d-flex"],["type","button",1,"btn","btn-danger","btn-sm"],["aria-hidden","true",1,"fa","fa-trash"],["type","button",1,"btn","btn-success","btn-sm"],["aria-hidden","true",1,"fa","fa-eye"],[1,"text-center","mx-auto","mt-5"],["role","status",1,"spinner-border","text-secondary"],[1,"visually-hidden"]],template:function(s,o){if(1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5"),e._uU(3,"Messagerie"),e.qZA(),e.TgZ(4,"button",2),e._UZ(5,"i",3),e._uU(6," Envoie Message "),e.qZA()()(),e.TgZ(7,"div",4),e.YNc(8,b,18,1,"div",5),e.YNc(9,v,4,0,"ng-template",null,6,e.W1O),e.qZA()),2&s){const r=e.MAs(10);e.xp6(8),e.Q6J("ngIf",o.data&&o.data.length>0)("ngIfElse",r)}},dependencies:[c.sg,c.O5,d.rH]})}return n})();var i=l(433),Z=l(8613);function T(n,a){1&n&&(e.TgZ(0,"div",31),e._uU(1," Veuillez renseigner l'objet "),e.qZA())}function x(n,a){if(1&n&&(e.TgZ(0,"option",32),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.s9C("value",t.id),e.xp6(1),e.AsE("",t.prenom," ",t.nom,"")}}function A(n,a){1&n&&(e.TgZ(0,"div",31),e._uU(1," Veuillez selectionner un utilisateur "),e.qZA())}function y(n,a){1&n&&(e.TgZ(0,"div",31),e._uU(1," Veuillez renseigner le contenu du message "),e.qZA())}function U(n,a){1&n&&e._UZ(0,"span",33)}function q(n,a){1&n&&(e.TgZ(0,"span"),e._uU(1,"Valider "),e.qZA())}let C=(()=>{class n{constructor(t,s,o,r){this.messageService=t,this.userService=s,this.fb=o,this.router=r,this.users=[],this.loading=!1,this.form=this.fb.group({messageF:["",i.kI.required,i.kI.minLength(3)],objectEmail:["",i.kI.required,i.kI.minLength(3)],recive:["",i.kI.required]})}ngOnInit(){this.getAllUsers()}get message(){return this.form.get("messageF")}get objet(){return this.form.get("objectEmail")}get recive(){return this.form.get("recive")}onSubmit(){let t=this.form.getRawValue();this.loading=!0,this.messageService.create(t).subscribe(s=>{console.log("data ",s.data),this.loading=!1,this.router.navigateByUrl("/message/list")},s=>{this.loading=!1,console.log("erreur ",s)})}getAllUsers(){this.userService.all().subscribe(t=>{this.users=t.data.users,console.log("User Details:",t)},t=>{console.log("erreur ",t)})}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(g.e),e.Y36(Z.K),e.Y36(i.qu),e.Y36(d.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-add"]],decls:41,vars:8,consts:[[1,"container-fluid","mybg-color","pb-5","mt-5","pt-5"],["role","alert","aria-live","assertive","aria-atomic","true",1,"toast","align-items-center","text-bg-primary","border-0"],[1,"d-flex"],[1,"toast-body"],["type","button","data-bs-dismiss","toast","aria-label","Close",1,"btn-close","btn-close-white","me-2","m-auto"],[1,"d-flex","justify-content-start","gap-5","gx-5","align-items-center"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item","text-secondary"],["routerLink","/message/list"],["aria-current","page",1,"breadcrumb-item","active"],[1,"container","pl-2","pr-2","shadow","rounded-5",2,"max-height","500px","overflow-y","auto"],[1,"card","border-0"],[1,"card-body"],[1,"card-title","text-center"],[1,"row","g-3",3,"formGroup","submit"],[1,"col-6"],["for","objectEmail",1,"form-label"],["type","text","id","objectEmail","formControlName","objectEmail","placeholder","Objet email",1,"form-control"],["class","text-danger",4,"ngIf"],[1,"col-md-6"],["for","recive",1,"form-label"],["id","recive","placeholder","Selectionner","formControlName","recive",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"col-12"],["for","messageF",1,"form-label"],["id","messageF","formControlName","messageF","rows","3",1,"form-control"],[1,"col-12","justify-content-end","mt-3"],["type","submit",1,"btn","mybg-color",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[4,"ngIf"],[1,"text-danger"],[3,"value"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(s,o){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4," Hello, world! This is a toast message. "),e.qZA(),e._UZ(5,"button",4),e.qZA()(),e.TgZ(6,"div",5)(7,"div")(8,"nav",6)(9,"ol",7)(10,"li",8)(11,"a",9),e._uU(12,"Message"),e.qZA()(),e.TgZ(13,"li",10),e._uU(14,"Envoie"),e.qZA()()()()()(),e.TgZ(15,"div",11)(16,"div",12)(17,"div",13)(18,"h5",14),e._uU(19,"Envoie message "),e.qZA(),e.TgZ(20,"form",15),e.NdJ("submit",function(){return o.onSubmit()}),e.TgZ(21,"div",16)(22,"label",17),e._uU(23,"Objet du message"),e.qZA(),e._UZ(24,"input",18),e.YNc(25,T,2,0,"div",19),e.qZA(),e.TgZ(26,"div",20)(27,"label",21),e._uU(28,"Utilisateur"),e.qZA(),e.TgZ(29,"select",22),e.YNc(30,x,2,3,"option",23),e.qZA(),e.YNc(31,A,2,0,"div",19),e.qZA(),e.TgZ(32,"div",24)(33,"label",25),e._uU(34,"Contenu"),e.qZA(),e._UZ(35,"textarea",26),e.YNc(36,y,2,0,"div",19),e.qZA(),e.TgZ(37,"div",27)(38,"button",28),e.YNc(39,U,1,0,"span",29),e.YNc(40,q,2,0,"span",30),e.qZA()()()()()()),2&s&&(e.xp6(20),e.Q6J("formGroup",o.form),e.xp6(5),e.Q6J("ngIf",(null==o.objet?null:o.objet.invalid)&&((null==o.objet?null:o.objet.dirty)||(null==o.objet?null:o.objet.touched))),e.xp6(5),e.Q6J("ngForOf",o.users),e.xp6(1),e.Q6J("ngIf",(null==o.recive?null:o.recive.invalid)&&((null==o.recive?null:o.recive.dirty)||(null==o.recive?null:o.recive.touched))),e.xp6(5),e.Q6J("ngIf",(null==o.message?null:o.message.invalid)&&((null==o.message?null:o.message.dirty)||(null==o.message?null:o.message.touched))),e.xp6(2),e.Q6J("disabled",o.loading||o.form.invalid),e.xp6(1),e.Q6J("ngIf",o.loading),e.xp6(1),e.Q6J("ngIf",!o.loading))},dependencies:[c.sg,c.O5,d.rH,i._Y,i.YN,i.Kr,i.Fj,i.EJ,i.JJ,i.JL,i.sg,i.u],styles:[".mybg-color[_ngcontent-%COMP%]{background-color:#0f7231;color:#fff}"]})}return n})();var p=l(2340),M=l(9837),j=l(629);const I=["myModal"];function F(n,a){1&n&&(e.TgZ(0,"div",11)(1,"div",12)(2,"span",13),e._uU(3,"Loading..."),e.qZA()()())}const J=function(n,a){return{"text-bg-success":n,"text-bg-danger":a}};function N(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",20)(1,"td",21),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"span",22),e._uU(9),e.qZA()(),e.TgZ(10,"td",23)(11,"button",24),e._UZ(12,"i",25),e.qZA(),e.TgZ(13,"button",26),e.NdJ("click",function(){const r=e.CHM(t).$implicit,u=e.oxw(3),V=e.MAs(15);return e.KtG(u.open(V,r.id,r.status))}),e._UZ(14,"i",27),e.qZA()()()}if(2&n){const t=a.$implicit,s=a.index,o=e.oxw(3);e.xp6(2),e.Oqu(s+1),e.xp6(2),e.Oqu(t.objectEmail),e.xp6(2),e.Oqu(t.message),e.xp6(2),e.Q6J("ngClass",e.WLB(5,J,o.status(t.status),!o.status(t.status))),e.xp6(1),e.hij(" ",o.statusText(t.status)," ")}}function Y(n,a){if(1&n&&(e.TgZ(0,"div",16)(1,"table",17)(2,"thead")(3,"tr")(4,"th",18),e._uU(5,"#"),e.qZA(),e.TgZ(6,"th",18),e._uU(7,"Objet"),e.qZA(),e.TgZ(8,"th",18),e._uU(9,"Message"),e.qZA(),e.TgZ(10,"th",18),e._uU(11,"Status"),e.qZA(),e.TgZ(12,"th",18),e._uU(13,"Actions"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,N,15,8,"tr",19),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(15),e.Q6J("ngForOf",t.data)}}function w(n,a){1&n&&(e.TgZ(0,"div",11)(1,"p"),e._uU(2,"Aucune donn\xe9e disponible."),e.qZA()())}function O(n,a){if(1&n&&(e.YNc(0,Y,16,1,"div",14),e.YNc(1,w,3,0,"ng-template",null,15,e.W1O)),2&n){const t=e.MAs(2),s=e.oxw();e.Q6J("ngIf",s.data&&s.data.length>0)("ngIfElse",t)}}function E(n,a){if(1&n&&(e.TgZ(0,"div",46),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.errorMessage," ")}}function k(n,a){1&n&&(e.TgZ(0,"div",47),e._uU(1," Objet obligatoire! "),e.qZA())}function R(n,a){1&n&&(e.TgZ(0,"div",47),e._uU(1," Contenu obligatoire! "),e.qZA())}function S(n,a){1&n&&e._UZ(0,"span",48)}function Q(n,a){1&n&&(e.TgZ(0,"span"),e._uU(1,"Valider "),e.qZA())}function L(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",28)(1,"h5",29),e._uU(2,"Message"),e.qZA(),e.TgZ(3,"button",30),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.closeModal())}),e.qZA()(),e.TgZ(4,"form",31),e.NdJ("submit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onSubmit())}),e.TgZ(5,"div",32)(6,"div",33),e.YNc(7,E,2,1,"div",34),e.TgZ(8,"div",35)(9,"label",36),e._uU(10,"Objet"),e.qZA(),e._UZ(11,"input",37),e.YNc(12,k,2,0,"div",38),e.qZA(),e.TgZ(13,"div",35)(14,"label",39),e._uU(15,"Contenu"),e.qZA(),e._UZ(16,"textarea",40),e.YNc(17,R,2,0,"div",38),e.qZA()()(),e.TgZ(18,"div",41)(19,"button",42),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.closeModal())}),e._uU(20,"Fermer"),e.qZA(),e.TgZ(21,"button",43),e.YNc(22,S,1,0,"span",44),e.YNc(23,Q,2,0,"span",45),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.replay),e.xp6(3),e.Q6J("ngIf",t.errorMessage),e.xp6(5),e.Q6J("ngIf",(null==t.objet?null:t.objet.invalid)&&((null==t.objet?null:t.objet.dirty)||(null==t.objet?null:t.objet.touched))),e.xp6(5),e.Q6J("ngIf",(null==t.message?null:t.message.invalid)&&((null==t.message?null:t.message.dirty)||(null==t.message?null:t.message.touched))),e.xp6(4),e.Q6J("disabled",t.loadingForm),e.xp6(1),e.Q6J("ngIf",t.loadingForm),e.xp6(1),e.Q6J("ngIf",!t.loadingForm)}}const G=[{path:"",component:f,children:[{path:"list",component:h},{path:"add",component:C},{path:"recive",component:(()=>{class n{constructor(t,s,o,r,u){this.messageService=t,this.fb=s,this.modalService=o,this.authService=r,this.location=u,this.data=[],this.loading=!1,this.loadingForm=!1,this.errorMessage="",this.url=`${p.N.api}/messages/allUser`,this.replay=this.fb.group({messageF:["",i.kI.required,i.kI.minLength(3)],objectEmail:["",i.kI.required,i.kI.minLength(3)]})}get message(){return this.replay.get("messageF")}get objet(){return this.replay.get("objectEmail")}ngOnInit(){this.url=`${p.N.api}/messages/allUser`,this.getUserConnected(),this.getMessages()}goBack(){this.location.back()}getMessages(){this.loading=!0,this.messageService.all(this.url).subscribe({next:t=>{this.loading=!1,console.log("data message ",t),this.data=t.data},error:t=>{this.loading=!1,console.log("error ",t)}})}onUpdate(t,s){"no-read"===s&&this.messageService.update(t,{id:t,status:"read"}).subscribe({next:r=>{console.log("data ",r.data),this.getMessages()},error:r=>{console.log("error ",r),this.errorMessage="Erreur survenu"}})}onSubmit(){let t=this.replay.getRawValue();this.loadingForm=!0,this.messageService.replay(t).subscribe({next:s=>{console.log("data ",s.data),this.loadingForm=!1,this.closeModal(),this.getMessages()},error:s=>{console.log("error ",s),this.loadingForm=!1,this.errorMessage="Erreur survenu"}})}getUserConnected(){this.authService.currentUser().subscribe({next:t=>{this.userconnected=t.data.user,console.log("error log ",t.data.user)},error:t=>{console.log("error log ",t)}})}openModal(t,s){this.onUpdate(t,s),this.replay.reset(),this.modalService.open(this.myModal,{backdrop:"static",keyboard:!1})}status(t){return"read"===t}statusText(t){return"read"===t?"lue":"non lue"}open(t,s,o){this.onUpdate(s,o),this.replay.reset(),this.modalService.open(t)}closeModal(){this.replay.reset(),this.modalService.dismissAll()}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(g.e),e.Y36(i.qu),e.Y36(M.FF),e.Y36(j.e),e.Y36(c.Ye))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-recive"]],viewQuery:function(s,o){if(1&s&&e.Gf(I,5),2&s){let r;e.iGM(r=e.CRH())&&(o.myModal=r.first)}},decls:16,vars:2,consts:[[1,"container-fluid","mybg-color","pb-5","mt-5","pt-5"],[1,"d-flex","justify-content-start","gap-5","gx-5","align-items-center"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item","text-primary"],[2,"cursor","pointer",3,"click"],["aria-current","page",1,"breadcrumb-item","active","text-white"],[1,"container","pl-2","pr-2","pb-2","shadow","rounded-5",2,"max-height","500px","overflow-y","auto"],["class","text-center mx-auto mt-5",4,"ngIf","ngIfElse"],["content",""],["myModal",""],[1,"text-center","mx-auto","mt-5"],["role","status",1,"spinner-border","text-secondary"],[1,"visually-hidden"],["class","table-responsive",4,"ngIf","ngIfElse"],["noData",""],[1,"table-responsive"],[1,"table","table-white","table-border-0","no-border"],["scope","col"],["class","",4,"ngFor","ngForOf"],[1,""],["scope","row"],[1,"badge",3,"ngClass"],[1,"gap-1","d-flex"],["type","button",1,"btn","btn-primary","btn-sm"],[1,"fa-solid","fa-eye"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa-solid","fa-reply"],[1,"modal-header"],["id","modalTitleId",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[3,"formGroup","submit"],[1,"modal-body"],[1,"row","g-3"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"col-md-12"],["for","validationCustom01",1,"form-label"],["type","text","id","objet","formControlName","objectEmail","value","Mark",1,"form-control"],["class","text-danger",4,"ngIf"],["for","messageF",1,"form-label"],["id","messageF","formControlName","messageF","rows","3",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","mybg-color",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"text-danger"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(s,o){if(1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"nav",2)(4,"ol",3)(5,"li",4)(6,"a",5),e.NdJ("click",function(){return o.goBack()}),e._uU(7,"retour"),e.qZA()(),e.TgZ(8,"li",6),e._uU(9,"Messages"),e.qZA()()()()()(),e.TgZ(10,"div",7),e.YNc(11,F,4,0,"div",8),e.YNc(12,O,3,2,"ng-template",null,9,e.W1O),e.qZA(),e.YNc(14,L,24,7,"ng-template",null,10,e.W1O)),2&s){const r=e.MAs(13);e.xp6(11),e.Q6J("ngIf",o.loading)("ngIfElse",r)}},dependencies:[c.mk,c.sg,c.O5,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u],styles:[".mybg-color[_ngcontent-%COMP%]{background-color:#0f7231;color:#fff}"]})}return n})()}]}];let B=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(G),d.Bz]})}return n})(),H=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[c.ez,B,i.UX]})}return n})()}}]);