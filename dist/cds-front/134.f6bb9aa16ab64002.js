"use strict";(self.webpackChunkcds_front=self.webpackChunkcds_front||[]).push([[134],{5134:(Z,m,s)=>{s.r(m),s.d(m,{SecureModule:()=>N});var l=s(6895),c=s(646),u=s(5481),t=s(1571),f=s(629);function i(n,h){1&n&&t._UZ(0,"div",11)}function _(n,h){if(1&n&&(t.TgZ(0,"a",13),t._uU(1),t.qZA()),2&n){const e=h.$implicit;t.Q6J("routerLink",e.link),t.xp6(1),t.hij(" ",e.name," ")}}function o(n,h){if(1&n&&(t.TgZ(0,"div",11),t.YNc(1,_,2,2,"a",12),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.menu)}}let p=(()=>{class n{constructor(e,a){this.router=e,this.authService=a,this.userconnected=u.g.user,this.menu=[],this.menu=[{name:"Dashbord",link:"/dashboard",acces:"super"},{name:"Utilisateur",link:"/dashboard",acces:"super"},{name:"Message",link:"/message/list",acces:"super"}]}ngOnInit(){this.getUserConnected()}getUserConnected(){this.authService.currentUser().subscribe({next:e=>{this.userconnected=e.data.user,console.log("error log ",e.data.user)},error:e=>{console.log("error log ",e)}})}logOut(){localStorage.removeItem("token"),localStorage.removeItem("userconnected"),u.g.user=null,this.router.navigate(["/"])}static#t=this.\u0275fac=function(a){return new(a||n)(t.Y36(c.F0),t.Y36(f.e))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-secure"]],decls:14,vars:2,consts:[[1,"navbar","shadow","navbar-expand-lg","mybg-color","text-white","fixed-top"],[1,"container-fluid","texte-white"],["href","javascript:void(0)",1,"navbar-brand"],["src","assets/images/cds.jpg","alt","Bootstrap","width","300","height","auto",1,"img-fluid"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],["class","navbar-nav mx-auto",4,"ngIf"],[1,"d-flex","my-2","my-lg-0"],["type","button",1,"btn","btn-white","my-2","my-sm-0",2,"color","rgb(255, 255, 255)",3,"click"],["aria-hidden","true",1,"fa","fa-sign-out"],[1,"navbar-nav","mx-auto"],["class","nav-link active w-col","style","color: rgb(255, 255, 255);",3,"routerLink",4,"ngFor","ngForOf"],[1,"nav-link","active","w-col",2,"color","rgb(255, 255, 255)",3,"routerLink"]],template:function(a,r){1&a&&(t.TgZ(0,"nav",0)(1,"div",1)(2,"a",2),t._UZ(3,"img",3),t.qZA(),t.TgZ(4,"button",4),t._UZ(5,"span",5),t.qZA(),t.TgZ(6,"div",6),t.YNc(7,i,1,0,"div",7),t.YNc(8,o,2,1,"div",7),t.TgZ(9,"div",8)(10,"a",9),t.NdJ("click",function(){return r.logOut()}),t._UZ(11,"i",10),t._uU(12," D\xe9connexion "),t.qZA()()()()(),t._UZ(13,"router-outlet")),2&a&&(t.xp6(7),t.Q6J("ngIf",r.userconnected&&"super"!==r.userconnected.role),t.xp6(1),t.Q6J("ngIf",r.userconnected&&"super"===r.userconnected.role))},dependencies:[l.sg,l.O5,c.lC,c.rH]})}return n})();var b=s(4332),T=s.n(b),A=s(8613),U=s(4873),C=s(6199),d=s(433);function x(n,h){1&n&&(t.TgZ(0,"div",47)(1,"span",48),t._uU(2,"Loading..."),t.qZA()())}const y=function(n,h){return{"bg-success":n,"bg-danger":h}},D=function(n){return["/user/details/",n]};function E(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"tr",37)(1,"td",38),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td")(6,"div",39)(7,"input",40),t.NdJ("change",function(r){const v=t.CHM(e).$implicit,J=t.oxw(2);return t.KtG(J.onActivate(v.id,r))}),t.qZA()(),t.YNc(8,x,3,0,"div",41),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td",42)(16,"button",43),t.NdJ("click",function(){const g=t.CHM(e).$implicit,v=t.oxw(2);return t.KtG(v.showValidation(g.id))}),t._UZ(17,"i",44),t.qZA(),t.TgZ(18,"a",45),t._UZ(19,"i",46),t.qZA()()()}if(2&n){const e=h.$implicit,a=t.oxw(2);t.xp6(2),t.AsE("",e.nom," ",e.prenom,""),t.xp6(2),t.Oqu(e.villeResidence?e.villeResidence:"........."),t.xp6(2),t.Q6J("hidden",a.loading&&e.id===a.currentId),t.xp6(1),t.s9C("id","flexSwitchCheckDefault-"+e.id),t.Q6J("ngClass",t.WLB(12,y,a.etat(e.active),!a.etat(e.active)))("ngModel",a.etat(e.active)),t.xp6(1),t.Q6J("ngIf",a.loading&&e.id===a.currentId),t.xp6(2),t.Oqu(e.email),t.xp6(2),t.Oqu(e.telephone),t.xp6(2),t.Oqu(e.dateNaiss),t.xp6(4),t.Q6J("routerLink",t.VKq(15,D,e.id))}}function O(n,h){if(1&n&&(t.TgZ(0,"div",33)(1,"table",34)(2,"thead")(3,"tr")(4,"th",35),t._uU(5,"Nom complet"),t.qZA(),t.TgZ(6,"th",35),t._uU(7,"Ville"),t.qZA(),t.TgZ(8,"th",35),t._uU(9,"Status"),t.qZA(),t.TgZ(10,"th",35),t._uU(11,"Email"),t.qZA(),t.TgZ(12,"th",35),t._uU(13,"T\xe9l\xe9phone"),t.qZA(),t.TgZ(14,"th",35),t._uU(15,"Date naissance"),t.qZA(),t.TgZ(16,"th",35),t._uU(17,"Actions"),t.qZA()()(),t.TgZ(18,"tbody"),t.YNc(19,E,20,17,"tr",36),t.qZA()()()),2&n){const e=t.oxw();t.xp6(19),t.Q6J("ngForOf",e.filteredData)}}function M(n,h){1&n&&(t.TgZ(0,"div",49)(1,"div",50)(2,"span",48),t._uU(3,"Loading..."),t.qZA()()())}let S=(()=>{class n{constructor(e,a,r){this.userService=e,this.ptService=a,this.msService=r,this.data=[],this.searchText="",this.filteredData=[],this.loading=!1,this.currentId="",this.userCount=0,this.messageCount=0,this.partenaireCount=0}ngOnInit(){this.findAllUsers(),this.filterData(),this.loadStatistics()}loadStatistics(){this.msService.all().subscribe(e=>{this.messageCount=e.data.length}),this.ptService.all().subscribe(e=>{this.partenaireCount=e.data.length})}findAllUsers(){this.searchText="",this.userService.all().subscribe({next:e=>{console.log("data data data : ",e.data),e.data&&Array.isArray(e.data.users)&&(this.userCount=e.data.users.length,this.data=e.data.users.slice().reverse(),this.filteredData=e.data.users.slice().reverse())},error:e=>{console.log("error ",e)}})}filterData(){if(this.data&&this.searchText){const e=this.searchText.toLowerCase();this.filteredData=this.data.filter(a=>a.villeResidence.toLowerCase()===e)}else this.filteredData=this.data}onActivate(e,a){this.currentId=e,this.loading=!0;const g={id:e,active:this.getEtat(a.target.checked)};this.userService.update(e,g).subscribe(v=>{this.loading=!1,this.findAllUsers(),console.log("data ",v.data)},v=>{this.loading=!1,console.log("erreur ",v)})}etat(e){return"active"===e}getEtat(e){return e?"active":"inactive"}onDelete(e){this.userService.delete(e).subscribe({next:a=>{this.findAllUsers(),console.log("data ",a.data)},error:a=>{console.log("erreur ",a)}})}showToast(e){T().success({title:"Succ\xe9s",message:e,position:"topRight"})}showValidation(e){T().question({timeout:0,close:!1,overlay:!0,displayMode:0,id:"question",zindex:999,title:"Suppression",message:"Voulez-vous supprimer ce compte ?",position:"center",buttons:[['<button class="font-bold btn btn-success" style="color: green!important">Confirmer</button>',(a,r)=>{this.onDelete(e),a.hide({transitionOut:"fadeOut"},r,"button"),this.showToast("Compte supprim\xe9 avec succ\xe9s.")},!0],['<button class="btn btn-danger" style="color: red!important">Annuler</button>',(a,r)=>{a.hide({transitionOut:"fadeOut"},r,"button")},!1]]})}static#t=this.\u0275fac=function(a){return new(a||n)(t.Y36(A.K),t.Y36(U.g),t.Y36(C.e))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-dashboard"]],decls:78,vars:7,consts:[[1,"container-fluid","mybg-color","pb-5","mt-5","pt-5"],[1,"d-flex","justify-content-between","align-items-center"],["routerLink","/user/add","type","button",1,"btn","btn-warning","rounded-pill"],["aria-hidden","true",1,"fa","fa-add"],[1,"container","pl-2","pr-2","pt-2"],[1,"row"],[1,"col-xl-3","col-md-6","mb-4"],[1,"card","border-left-success","shadow","h-100","py-2"],[1,"card-body"],[1,"row","no-gutters","align-items-center"],[1,"col","mr-2"],[1,"text-xs","font-weight-bold","text-success","text-uppercase","mb-1"],[1,"h5","mb-0","font-weight-bold","text-gray-800"],[1,"container","pl-2","pr-2","pb-2","shadow","rounded-5","mb-2",2,"max-height","500px","overflow-y","auto"],[1,"row","row-cols-lg-auto","g-3","align-items-center","mt-3","mb-2"],[1,"col-md-6"],["for","inlineFormSelectPref",1,"visually-hidden"],["name","searchText","id","inlineFormSelectPref",1,"form-select",3,"ngModel","change","ngModelChange"],["selected","","value",""],["value","nantes"],["value","rennes"],["value","anger"],["value","le mans"],["value","brest"],["value","Caen"],["value","quimper"],["value","saint-nazaire"],["value","autres"],[1,"col-12"],["type","button",1,"btn","btn-success",3,"click"],[1,"fa-solid","fa-arrows-rotate"],["class","table-responsive",4,"ngIf","ngIfElse"],["placeholder",""],[1,"table-responsive"],[1,"table","table-white","table-border-0","no-border"],["scope","col"],["class","",4,"ngFor","ngForOf"],[1,""],["scope","row"],[1,"form-check","form-switch",3,"hidden"],["type","checkbox","role","switch",1,"form-check-input",3,"ngClass","id","ngModel","change"],["class","spinner-grow spinner-grow-sm text-secondary","role","status",4,"ngIf"],[1,"gap-1","d-flex"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-trash"],["type","button",1,"btn","btn-success","btn-sm",3,"routerLink"],["aria-hidden","true",1,"fa","fa-eye"],["role","status",1,"spinner-grow","spinner-grow-sm","text-secondary"],[1,"visually-hidden"],[1,"text-center","mx-auto","mt-5"],["role","status",1,"spinner-border","text-secondary"]],template:function(a,r){if(1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5"),t._uU(3,"Utilisateur"),t.qZA(),t.TgZ(4,"button",2),t._UZ(5,"i",3),t._uU(6," Ajouter utilisateur "),t.qZA()()(),t.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11),t._uU(15," Total utilisateur "),t.qZA(),t.TgZ(16,"div",5)(17,"div",12),t._uU(18),t.qZA()()()()()()(),t.TgZ(19,"div",6)(20,"div",7)(21,"div",8)(22,"div",9)(23,"div",10)(24,"div",11),t._uU(25," Total messages "),t.qZA(),t.TgZ(26,"div",12),t._uU(27),t.qZA()()()()()(),t.TgZ(28,"div",6)(29,"div",7)(30,"div",8)(31,"div",9)(32,"div",10)(33,"div",11),t._uU(34," Total messages "),t.qZA(),t.TgZ(35,"div",12),t._uU(36),t.qZA()()()()()(),t.TgZ(37,"div",6)(38,"div",7)(39,"div",8)(40,"div",9)(41,"div",10)(42,"div",11),t._uU(43," Total partenaires "),t.qZA(),t.TgZ(44,"div",12),t._uU(45),t.qZA()()()()()()()(),t.TgZ(46,"div",13)(47,"form",14)(48,"div",15)(49,"label",16),t._uU(50,"Ville de r\xe9sidence"),t.qZA(),t.TgZ(51,"select",17),t.NdJ("change",function(){return r.filterData()})("ngModelChange",function(v){return r.searchText=v}),t.TgZ(52,"option",18),t._uU(53,"S\xe9lectionnez une ville..."),t.qZA(),t.TgZ(54,"option",19),t._uU(55,"Nantes"),t.qZA(),t.TgZ(56,"option",20),t._uU(57,"Rennes"),t.qZA(),t.TgZ(58,"option",21),t._uU(59,"Anger"),t.qZA(),t.TgZ(60,"option",22),t._uU(61,"Le mans"),t.qZA(),t.TgZ(62,"option",23),t._uU(63,"Brest"),t.qZA(),t.TgZ(64,"option",24),t._uU(65,"Caen"),t.qZA(),t.TgZ(66,"option",25),t._uU(67,"Quimper"),t.qZA(),t.TgZ(68,"option",26),t._uU(69,"Saint-nazaire"),t.qZA(),t.TgZ(70,"option",27),t._uU(71,"Autres"),t.qZA()()(),t.TgZ(72,"div",28)(73,"button",29),t.NdJ("click",function(){return r.findAllUsers()}),t._UZ(74,"i",30),t.qZA()()(),t.YNc(75,O,20,1,"div",31),t.YNc(76,M,4,0,"ng-template",null,32,t.W1O),t.qZA()),2&a){const g=t.MAs(77);t.xp6(18),t.hij(" ",r.userCount," "),t.xp6(9),t.hij(" ",r.messageCount," "),t.xp6(9),t.Oqu(r.messageCount),t.xp6(9),t.hij(" ",r.partenaireCount," "),t.xp6(6),t.Q6J("ngModel",r.searchText),t.xp6(24),t.Q6J("ngIf",r.data&&r.data.length>0)("ngIfElse",g)}},dependencies:[l.mk,l.sg,l.O5,c.rH,d._Y,d.YN,d.Kr,d.Wl,d.EJ,d.JJ,d.JL,d.On,d.F]})}return n})();const P=[{path:"",component:p,canActivate:[s(5240).a],children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:S},{path:"user",loadChildren:()=>Promise.all([s.e(592),s.e(445)]).then(s.bind(s,445)).then(n=>n.UserModule)},{path:"message",loadChildren:()=>s.e(425).then(s.bind(s,5425)).then(n=>n.MessageModule)},{path:"partenaire",loadChildren:()=>Promise.all([s.e(592),s.e(968)]).then(s.bind(s,5968)).then(n=>n.PartenaireModule)}]}];let L=(()=>{class n{static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(P),c.Bz]})}return n})(),N=(()=>{class n{static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[l.ez,L,d.u5,d.UX]})}return n})()},6199:(Z,m,s)=>{s.d(m,{e:()=>f});var l=s(2671),c=s(2340),u=s(1571),t=s(529);let f=(()=>{class i extends l.v{uri(){return"messages"}constructor(o){super(o),this.http=o}replay(o){return this.http.post(`${c.N.api}/${this.uri()}/replay`,o)}static#t=this.\u0275fac=function(p){return new(p||i)(u.LFG(t.eN))};static#e=this.\u0275prov=u.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},4873:(Z,m,s)=>{s.d(m,{g:()=>f});var l=s(2340),c=s(2671),u=s(1571),t=s(529);let f=(()=>{class i extends c.v{uri(){return"partenaires"}constructor(o){super(o),this.http=o}all(o=null){return null==o&&(o=`${l.N.api}/${this.uri()}/allByUser`),this.http.get(`${o}`)}static#t=this.\u0275fac=function(p){return new(p||i)(u.LFG(t.eN))};static#e=this.\u0275prov=u.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()},8613:(Z,m,s)=>{s.d(m,{K:()=>f});var l=s(2340),c=s(2671),u=s(1571),t=s(529);let f=(()=>{class i extends c.v{uri(){return"users"}constructor(o){super(o),this.http=o}update(o,p){return this.http.put(`${l.N.api}/${this.uri()}/${o}`,p)}transaction(){return this.http.post(`${l.N.api}/transactions`,{})}all(o=null){return null==o&&(o=`${l.N.api}/${this.uri()}/all`),this.http.get(`${o}`)}getUser(){const o=localStorage.getItem("userconnected");return o?JSON.parse(o):null}static#t=this.\u0275fac=function(p){return new(p||i)(u.LFG(t.eN))};static#e=this.\u0275prov=u.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})()}}]);