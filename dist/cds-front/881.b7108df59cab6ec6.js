"use strict";(self.webpackChunkcds_front=self.webpackChunkcds_front||[]).push([[881],{1881:(ce,g,u)=>{u.r(g),u.d(g,{PartenaireModule:()=>ue});var p=u(6895),d=u(646),e=u(1571);let Z=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-partenaire"]],decls:1,vars:0,template:function(i,n){1&i&&e._UZ(0,"router-outlet")},dependencies:[d.lC]})}return r})();var o=u(433),h=u(8613),m=u(4873),_=u(2965),f=u(629);function b(r,a){if(1&r&&(e.TgZ(0,"div",47),e._uU(1),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.errorMessage," ")}}function y(r,a){1&r&&(e.TgZ(0,"div",48),e._uU(1," Renseigner le nom "),e.qZA())}function T(r,a){1&r&&(e.TgZ(0,"div",48),e._uU(1," Renseigner le pr\xe9nom "),e.qZA())}function A(r,a){1&r&&(e.TgZ(0,"div",48),e._uU(1," Renseigner le type "),e.qZA())}function U(r,a){1&r&&(e.TgZ(0,"div",48),e._uU(1," Renseigner le sexe "),e.qZA())}function x(r,a){1&r&&(e.TgZ(0,"div",48),e._uU(1," Renseigner le Num\xe9ro de t\xe9l\xe9phone "),e.qZA())}function S(r,a){if(1&r&&(e.TgZ(0,"div",48),e._uU(1),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.verifTel," ")}}function q(r,a){1&r&&(e.TgZ(0,"div",48),e._uU(1," Renseigner le pays "),e.qZA())}function C(r,a){1&r&&(e.TgZ(0,"div",48),e._uU(1," Renseigner la ville "),e.qZA())}function I(r,a){1&r&&(e.TgZ(0,"div",48),e._uU(1," Renseigner le rue "),e.qZA())}function N(r,a){1&r&&(e.TgZ(0,"div",48),e._uU(1," Renseigner le Num\xe9ro s\xe9curit\xe9 "),e.qZA())}function J(r,a){if(1&r&&(e.TgZ(0,"div",48),e._uU(1),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.verifSecure," ")}}function Y(r,a){1&r&&e._UZ(0,"span",49)}function k(r,a){1&r&&(e.TgZ(0,"span"),e._uU(1,"Valider "),e.qZA())}function E(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"h5",12),e._uU(3,"Ajout partenaire "),e.qZA(),e.TgZ(4,"form",13),e.NdJ("submit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onSubmit())}),e.YNc(5,b,2,1,"div",14),e.TgZ(6,"div",15)(7,"label",16),e._uU(8,"Nom"),e.qZA(),e._UZ(9,"input",17),e.YNc(10,y,2,0,"div",18),e.qZA(),e.TgZ(11,"div",15)(12,"label",16),e._uU(13,"Pr\xe9nom"),e.qZA(),e._UZ(14,"input",19),e.YNc(15,T,2,0,"div",18),e.qZA(),e.TgZ(16,"div",15)(17,"label",20),e._uU(18,"Type"),e.qZA(),e.TgZ(19,"select",21)(20,"option",22),e._uU(21,"Partenaire"),e.qZA(),e.TgZ(22,"option",23),e._uU(23,"Enfant"),e.qZA()(),e.YNc(24,A,2,0,"div",18),e.qZA(),e.TgZ(25,"div",15)(26,"label",24),e._uU(27,"Sexe"),e.qZA(),e.TgZ(28,"select",25)(29,"option",26),e._uU(30,"Homme"),e.qZA(),e.TgZ(31,"option",27),e._uU(32,"Femme"),e.qZA()(),e.YNc(33,U,2,0,"div",18),e.qZA(),e.TgZ(34,"div",28)(35,"label",29),e._uU(36,"T\xe9l\xe9phone"),e.qZA(),e.TgZ(37,"input",30),e.NdJ("keypress",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.validateInput(n))})("input",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onChangeTelephone())}),e.qZA(),e.YNc(38,x,2,0,"div",18),e.YNc(39,S,2,1,"div",18),e.qZA(),e.TgZ(40,"div",28)(41,"label",31),e._uU(42,"Pays"),e.qZA(),e._UZ(43,"input",32),e.YNc(44,q,2,0,"div",18),e.qZA(),e.TgZ(45,"div",33)(46,"label",34),e._uU(47,"Ville"),e.qZA(),e._UZ(48,"input",35),e.YNc(49,C,2,0,"div",18),e.qZA(),e.TgZ(50,"div",33)(51,"label",36),e._uU(52,"Rue"),e.qZA(),e._UZ(53,"input",37),e.YNc(54,I,2,0,"div",18),e.qZA(),e.TgZ(55,"div",33)(56,"label",38),e._uU(57,"Num\xe9ro s\xe9curit\xe9 sociale"),e.qZA(),e.TgZ(58,"input",39),e.NdJ("keypress",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.validateInput(n))})("input",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.setupSecuritySocilaValidation())}),e.qZA(),e.YNc(59,N,2,0,"div",18),e.YNc(60,J,2,1,"div",18),e.qZA(),e.TgZ(61,"div",15)(62,"label",40),e._uU(63,"Profil"),e.qZA(),e.TgZ(64,"input",41),e.NdJ("change",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.displayFileName(n,1))}),e.qZA()(),e.TgZ(65,"div",15)(66,"label",40),e._uU(67,"Justificatif"),e.qZA(),e.TgZ(68,"input",42),e.NdJ("change",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.displayFileName(n,2))}),e.qZA()(),e.TgZ(69,"div",43)(70,"button",44),e.YNc(71,Y,1,0,"span",45),e.YNc(72,k,2,0,"span",46),e.qZA()()()()()}if(2&r){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.errorMessage),e.xp6(5),e.Q6J("ngIf",(null==t.nom?null:t.nom.invalid)&&((null==t.nom?null:t.nom.dirty)||(null==t.nom?null:t.nom.touched))),e.xp6(5),e.Q6J("ngIf",(null==t.prenom?null:t.prenom.invalid)&&((null==t.prenom?null:t.prenom.dirty)||(null==t.prenom?null:t.prenom.touched))),e.xp6(9),e.Q6J("ngIf",(null==t.type?null:t.type.invalid)&&((null==t.type?null:t.type.dirty)||(null==t.type?null:t.type.touched))),e.xp6(9),e.Q6J("ngIf",(null==t.sexe?null:t.sexe.invalid)&&((null==t.sexe?null:t.sexe.dirty)||(null==t.sexe?null:t.sexe.touched))),e.xp6(5),e.Q6J("ngIf",(null==t.telephone?null:t.telephone.invalid)&&((null==t.telephone?null:t.telephone.dirty)||(null==t.telephone?null:t.telephone.touched))),e.xp6(1),e.Q6J("ngIf",t.verifTel),e.xp6(5),e.Q6J("ngIf",(null==t.pays?null:t.pays.invalid)&&((null==t.pays?null:t.pays.dirty)||(null==t.pays?null:t.pays.touched))),e.xp6(5),e.Q6J("ngIf",(null==t.ville?null:t.ville.invalid)&&((null==t.ville?null:t.ville.dirty)||(null==t.ville?null:t.ville.touched))),e.xp6(5),e.Q6J("ngIf",(null==t.rue?null:t.rue.invalid)&&((null==t.rue?null:t.rue.dirty)||(null==t.rue?null:t.rue.touched))),e.xp6(5),e.Q6J("ngIf",(null==t.numeroSecuriteSocial?null:t.numeroSecuriteSocial.invalid)&&((null==t.numeroSecuriteSocial?null:t.numeroSecuriteSocial.dirty)||(null==t.numeroSecuriteSocial?null:t.numeroSecuriteSocial.touched))),e.xp6(1),e.Q6J("ngIf",t.verifSecure),e.xp6(10),e.Q6J("disabled",t.loading||t.form.invalid),e.xp6(1),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",!t.loading)}}function w(r,a){1&r&&(e.TgZ(0,"div",50),e._uU(1," Vous ne pouvez pas ajouter de partenaires. "),e.qZA())}const j=function(r){return["/partenaire/list",r]};let Q=(()=>{class r{constructor(t,i,n,l,s,c,de){this.userService=t,this.route=i,this.ptService=n,this.fileService=l,this.authService=s,this.router=c,this.fb=de,this.loading=!1,this.errorMessage="",this.verifMail="",this.verifSecure="",this.verifTel="",this.form=this.fb.group({type:["",o.kI.required],profile:[null],nom:["",o.kI.required],prenom:["",o.kI.required],telephone:["",o.kI.required,o.kI.minLength(9),o.kI.maxLength(15)],pays:["",o.kI.required],ville:["",o.kI.required],code_postal:[""],rue:["",o.kI.required],numero_rue:[""],numeroSecuriteSocial:["",[o.kI.required,o.kI.pattern(/^\d{13}$/)]],sexe:["",o.kI.required],justificatif:[null]})}ngOnInit(){this.userId=this.route.snapshot.params.userId,this.getOneUser(),this.ptService.sharedData=this.userId}getUserConnected(){this.authService.currentUser().subscribe({next:t=>{this.userconnected=t.data.user,console.log("error log ",t.data.user)},error:t=>{console.log("error log ",t)}})}getOneUser(){this.userService.byId(this.userId).subscribe({next:t=>{console.log("users ",t.data.users),this.userconnected=t.data.users},error:t=>{this.loading=!1,console.log("erreur ",t)}})}get getNbrPartenaires(){return this.userconnected?.partenaires.length}get checkPartenaire(){let t=!1;switch(console.log("type a : ",this.userconnected?.typeAbonnement),this.userconnected?.typeAbonnement){case"3":t=1!=this.userconnected?.partenaires.length,console.log("retour ",t);break;case"4":case"5":t=!0;break;default:t=!1}return t}get nom(){return this.form.get("nom")}get prenom(){return this.form.get("prenom")}get ville(){return this.form.get("ville")}get villeResidence(){return this.form.get("villeResidence")}get telephone(){return this.form.get("telephone")}get rue(){return this.form.get("rue")}get sexe(){return this.form.get("sexe")}get type(){return this.form.get("type")}get pays(){return this.form.get("pays")}get code_postal(){return this.form.get("code_postal")}get numeroSecuriteSocial(){return this.form.get("numeroSecuriteSocial")}displayFileName(t,i){console.log("Nom du fichier :",t.target.files[0].name);const l=t.target.files[0];if(l){const s=new FileReader;s.onloadend=()=>{this.saveFile(s.result,i)},s.readAsDataURL(l)}}saveFile(t,i){this.fileService.create({image:t}).subscribe({next:l=>{1===i?this.form.patchValue({profile:l.data.id}):2==i&&this.form.patchValue({justificatif:l.data.id}),console.log("data ",l.data.id)},error:l=>{console.error("file upload error:",l)}})}onSubmit(){let t=this.form.getRawValue();this.loading=!0,console.log("values form : ",t),this.ptService.create(t).subscribe(i=>{this.errorMessage="",console.log("data ",i.data),this.loading=!1,i.data.errors?this.errorMessage="Une erreur est survenue":this.router.navigateByUrl("/partenaire/list/"+this.userId)},i=>{this.loading=!1,this.errorMessage="Une erreur est survenue",console.log("error ",i)})}setupSecuritySocilaValidation(){this.numeroSecuriteSocial?.valid&&this.authService.verifInfos({numeroSecuriteSocial:this.numeroSecuriteSocial?.value},"verifNumeroSocial").subscribe(i=>{this.verifSecure=403===i.statusCode?"Le num\xe9ro de s\xe9curit\xe9 social existe d\xe9j\xe0.":""},i=>{console.error("Erreur lors de la validation de l'e-mail:",i),this.verifSecure="Le num\xe9ro de s\xe9curit\xe9 social existe d\xe9j\xe0."})}onChangeTelephone(){this.telephone?.valid&&this.authService.verifInfos({telephone:this.telephone?.value},"verifTelephone").subscribe(i=>{403===i.statusCode?this.verifSecure="Le num\xe9ro existe d\xe9j\xe0.":this.verifTel=""},i=>{console.error("Erreur lors de la validation de l'e-mail:",i),this.verifTel="Le num\xe9ro de t\xe9l\xe9hone  \xe9xiste d\xe9j\xe0."})}validateInput(t){/^\d+$/.test(t.key)||t.preventDefault()}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(h.K),e.Y36(d.gz),e.Y36(m.g),e.Y36(_.I),e.Y36(f.e),e.Y36(d.F0),e.Y36(o.qu))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-add"]],decls:14,vars:5,consts:[[1,"container-fluid","mybg-color","pb-5","mt-5","pt-5"],[1,"d-flex","justify-content-start","gap-5","gx-5","align-items-center"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],[2,"color","white",3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active","text-white"],[1,"container","pl-2","pr-2","shadow","rounded-5",2,"max-height","500px","overflow-y","auto"],["class","card border-0",4,"ngIf","ngIfElse"],["message",""],[1,"card","border-0"],[1,"card-body"],[1,"card-title","text-center"],[1,"row","g-3",3,"formGroup","submit"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"col-md-6"],["for","objectEmail",1,"form-label"],["type","text","id","nom","formControlName","nom","placeholder","nom",1,"form-control"],["class","text-danger",4,"ngIf"],["type","text","id","prneom","formControlName","prenom","placeholder","prenom",1,"form-control"],["for","recive",1,"form-label"],["id","type","placeholder","Selectionner","formControlName","type",1,"form-select"],["value","partenaires"],["value","enfants"],["for","sexe",1,"form-label"],["id","sexe","placeholder","Selectionner","formControlName","sexe",1,"form-select"],["value","homme"],["value","femme"],[1,"col-sm-6"],["for","telephone",1,"form-label"],["type","text","id","telephone","formControlName","telephone","maxlength","15","placeholder","t\xe9l\xe9phone",1,"form-control",3,"keypress","input"],["for","pays",1,"form-label"],["type","text","id","pays","formControlName","pays","placeholder","pays",1,"form-control"],[1,"col-sm-4"],["for","ville",1,"form-label"],["type","text","id","ville","formControlName","ville","placeholder","ville",1,"form-control"],["for","rue",1,"form-label"],["type","text","id","rue","formControlName","rue","placeholder","rue",1,"form-control"],["for","numeroSecuriteSocial",1,"form-label"],["type","text","id","numeroSecuriteSocial","formControlName","numeroSecuriteSocial","maxlength","13","placeholder","numeroSecuriteSocial",1,"form-control",3,"keypress","input"],["for","formFile",1,"form-label"],["type","file","formControlName","profile","id","profil",1,"form-control",3,"change"],["type","file","id","justificatif","formControlName","justificatif",1,"form-control",3,"change"],[1,"col-12","justify-content-end","mt-3"],["type","submit",1,"btn","mybg-color","float-end","btn-lg",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"text-danger"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"fs4","text-center","p-4"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"nav",2)(4,"ol",3)(5,"li",4)(6,"a",5),e._uU(7,"Partenaire"),e.qZA()(),e.TgZ(8,"li",6),e._uU(9,"Ajout"),e.qZA()()()()()(),e.TgZ(10,"div",7),e.YNc(11,E,73,16,"div",8),e.YNc(12,w,2,0,"ng-template",null,9,e.W1O),e.qZA()),2&i){const l=e.MAs(13);e.xp6(6),e.Q6J("routerLink",e.VKq(3,j,n.userId)),e.xp6(5),e.Q6J("ngIf",n.checkPartenaire)("ngIfElse",l)}},dependencies:[p.O5,d.rH,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.nD,o.sg,o.u],styles:[".mybg-color[_ngcontent-%COMP%]{background-color:#0f7231;color:#fff}"]})}return r})();var L=u(2340),M=u(4332),v=u.n(M);function R(r,a){1&r&&(e.TgZ(0,"div",13)(1,"div",14)(2,"span",15),e._uU(3,"Loading..."),e.qZA()()())}const F=function(r){return["/partenaire/update/",r]};function P(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"tr",22)(1,"td",23),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td",24)(12,"button",25),e.NdJ("click",function(){const l=e.CHM(t).$implicit,s=e.oxw(3);return e.KtG(s.showValidation(l.id))}),e._UZ(13,"i",26),e.qZA(),e.TgZ(14,"a",27),e._UZ(15,"i",28),e.qZA(),e.TgZ(16,"a",29),e._UZ(17,"i",28),e.qZA(),e.TgZ(18,"a",30),e._UZ(19,"i",31),e.qZA()()()}if(2&r){const t=a.$implicit,i=a.index;e.xp6(2),e.hij("",i+1," "),e.xp6(2),e.AsE("",t.nom," ",t.prenom,""),e.xp6(2),e.Oqu(t.telephone),e.xp6(2),e.Oqu(t.type),e.xp6(2),e.Oqu(t.sexe),e.xp6(4),e.s9C("href",t.justificatif.url,e.LSH),e.xp6(2),e.s9C("href",t.profile.url,e.LSH),e.xp6(2),e.Q6J("routerLink",e.VKq(9,F,t.id))}}function O(r,a){if(1&r&&(e.TgZ(0,"div",18)(1,"table",19)(2,"thead")(3,"tr")(4,"th",20),e._uU(5,"#"),e.qZA(),e.TgZ(6,"th",20),e._uU(7,"Nom & pr\xe9nom"),e.qZA(),e.TgZ(8,"th",20),e._uU(9,"T\xe9l\xe9phone"),e.qZA(),e.TgZ(10,"th",20),e._uU(11,"Type "),e.qZA(),e.TgZ(12,"th",20),e._uU(13,"Sexe"),e.qZA(),e.TgZ(14,"th",20),e._uU(15,"Actions"),e.qZA()()(),e.TgZ(16,"tbody"),e.YNc(17,P,20,11,"tr",21),e.qZA()()()),2&r){const t=e.oxw(2);e.xp6(17),e.Q6J("ngForOf",t.data)}}function V(r,a){1&r&&(e.TgZ(0,"div",13)(1,"p"),e._uU(2,"Aucune donn\xe9e disponible."),e.qZA()())}function H(r,a){if(1&r&&(e.YNc(0,O,18,1,"div",16),e.YNc(1,V,3,0,"ng-template",null,17,e.W1O)),2&r){const t=e.MAs(2),i=e.oxw();e.Q6J("ngIf",i.data&&i.data.length>0)("ngIfElse",t)}}const K=function(r){return["/partenaire/add",r]};function B(r,a){if(1&r&&(e.TgZ(0,"div",45),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.errorMessage," ")}}function G(r,a){1&r&&(e.TgZ(0,"div",46),e._uU(1," Renseigner le nom "),e.qZA())}function z(r,a){1&r&&(e.TgZ(0,"div",46),e._uU(1," Renseigner le pr\xe9nom "),e.qZA())}function $(r,a){1&r&&(e.TgZ(0,"div",46),e._uU(1," Renseigner le type "),e.qZA())}function X(r,a){1&r&&(e.TgZ(0,"div",46),e._uU(1," Renseigner le sexe "),e.qZA())}function W(r,a){1&r&&(e.TgZ(0,"div",46),e._uU(1," Renseigner le Num\xe9ro de t\xe9l\xe9phone "),e.qZA())}function ee(r,a){if(1&r&&(e.TgZ(0,"div",46),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.verifTel," ")}}function te(r,a){1&r&&(e.TgZ(0,"div",46),e._uU(1," Renseigner le pays "),e.qZA())}function re(r,a){1&r&&(e.TgZ(0,"div",46),e._uU(1," Renseigner la ville "),e.qZA())}function ne(r,a){1&r&&(e.TgZ(0,"div",46),e._uU(1," Renseigner le rue "),e.qZA())}function ie(r,a){1&r&&(e.TgZ(0,"div",46),e._uU(1," Renseigner le Num\xe9ro s\xe9curit\xe9 "),e.qZA())}function oe(r,a){1&r&&e._UZ(0,"span",47)}function le(r,a){1&r&&(e.TgZ(0,"span"),e._uU(1,"Valider "),e.qZA())}const ae=[{path:"",component:Z,children:[{path:"list/:userId",component:(()=>{class r{constructor(t,i,n,l,s,c){this.ptService=t,this.userService=i,this.route=n,this.router=l,this.location=s,this.authService=c,this.data=[],this.urlp="",this.loading=!1}ngOnInit(){this.urlp=`${L.N.api}/partenaires/allByUser`,this.userId=this.route.snapshot.params.userId,this.getOneUser(),this.getUserConnected()}goBack(){this.router.navigateByUrl("/user/details/"+this.userId)}getUserConnected(){this.authService.currentUser().subscribe({next:t=>{this.userconnected=t.data.user,console.log("error log ",t.data.user)},error:t=>{console.log("error log ",t)}})}getAll(){this.loading=!0,this.ptService.all(this.urlp).subscribe({next:t=>{this.loading=!1,console.log("data ",t.data),this.data=t.data},error:t=>{this.loading=!1,console.log("error ",t)}})}getOneUser(){this.loading=!0,console.log("breukh avant "),this.userService.byId(this.userId).subscribe({next:t=>{this.loading=!1,this.userDetails=t.data.users,this.data=t.data.users.partenaires},error:t=>{this.loading=!1,console.log("erreur ",t)}})}onDelete(t){this.ptService.delete(t).subscribe({next:i=>{this.getOneUser(),console.log("data ",i.data)},error:i=>{console.log("erreur ",i)}})}showToast(t){v().success({title:"Succ\xe9s",message:t,position:"topRight"})}showValidation(t){v().question({timeout:0,close:!1,overlay:!0,displayMode:0,id:"question",zindex:999,title:"Suppression",message:"Voulez-vous supprimer ce partenaire ?",position:"center",buttons:[['<button class="font-bold btn btn-success" style="color: green!important">Confirmer</button>',(i,n)=>{this.onDelete(t),i.hide({transitionOut:"fadeOut"},n,"button"),this.showToast("Partenaire supprim\xe9 avec succ\xe9s.")},!0],['<button class="btn btn-danger" style="color: red!important">Annuler</button>',(i,n)=>{i.hide({transitionOut:"fadeOut"},n,"button")},!1]]})}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(m.g),e.Y36(h.K),e.Y36(d.gz),e.Y36(d.F0),e.Y36(p.Ye),e.Y36(f.e))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-list"]],decls:20,vars:5,consts:[[1,"container-fluid","mybg-color","pb-5","mt-5","pt-5"],[1,"d-flex","justify-content-start","gap-5","gx-5","align-items-center"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],[2,"color","white","cursor","pointer",3,"click"],["aria-current","page",1,"breadcrumb-item","active","text-white"],[1,"d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-warning","rounded-pill",3,"routerLink"],["aria-hidden","true",1,"fa","fa-add"],[1,"container","pl-2","pr-2","pb-2","shadow","rounded-5",2,"max-height","500px","overflow-y","auto"],["class","text-center mx-auto mt-5",4,"ngIf","ngIfElse"],["content",""],[1,"text-center","mx-auto","mt-5"],["role","status",1,"spinner-border","text-secondary"],[1,"visually-hidden"],["class","table-responsive",4,"ngIf","ngIfElse"],["noData",""],[1,"table-responsive"],[1,"table","table-white","table-border-0","no-border"],["scope","col"],["class","",4,"ngFor","ngForOf"],[1,""],["scope","row"],[1,"gap-1","d-flex"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-trash"],["type","button","target","_blank","title","Justificatif",1,"btn","btn-warning","btn-sm",3,"href"],[1,"fa-solid","fa-paperclip"],["type","button","target","_blank","title","Profile",1,"btn","btn-primary","btn-sm",3,"href"],["type","button",1,"btn","btn-success","btn-sm",3,"routerLink"],["aria-hidden","true",1,"fa","fa-edit"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"nav",2)(4,"ol",3)(5,"li",4)(6,"a",5),e.NdJ("click",function(){return n.goBack()}),e._uU(7,"Retour"),e.qZA()(),e.TgZ(8,"li",6),e._uU(9,"Partenaires"),e.qZA()()()()(),e.TgZ(10,"div",7)(11,"h5"),e._uU(12,"Partenaires"),e.qZA(),e.TgZ(13,"button",8),e._UZ(14,"i",9),e._uU(15," Ajouter "),e.qZA()()(),e.TgZ(16,"div",10),e.YNc(17,R,4,0,"div",11),e.YNc(18,H,3,2,"ng-template",null,12,e.W1O),e.qZA()),2&i){const l=e.MAs(19);e.xp6(13),e.Q6J("routerLink",e.VKq(3,K,n.userId)),e.xp6(4),e.Q6J("ngIf",n.loading)("ngIfElse",l)}},dependencies:[p.sg,p.O5,d.rH]})}return r})()},{path:"add/:userId",component:Q},{path:"update/:id",component:(()=>{class r{constructor(t,i,n,l,s,c){this.ptService=t,this.fileService=i,this.authService=n,this.router=l,this.fb=s,this.route=c,this.loading=!1,this.onUpdateJustificatif=!1,this.onUpdateProfile=!1,this.verifMail="",this.verifSecure="",this.verifTel="",this.errorMessage="",this.form=this.fb.group({type:["",o.kI.required],profile:[null],nom:["",o.kI.required],prenom:["",o.kI.required],telephone:["",[o.kI.required,o.kI.minLength(9),o.kI.maxLength(15)]],pays:["",o.kI.required],ville:["",o.kI.required],code_postal:[""],rue:["",o.kI.required],numero_rue:[""],numeroSecuriteSocial:["",[o.kI.required,o.kI.pattern(/^\d{13}$/)]],sexe:["",o.kI.required],justificatif:[null]})}ngOnInit(){this.userId=this.ptService.sharedData,this.partenaireId=this.route.snapshot.params.id,this.getPartenaireById(),this.getUserConnected(),this.ptService.sharedData=this.userId}getPartenaireById(){this.ptService.byId(this.partenaireId).subscribe({next:t=>{console.log("data ",t.data),this.data=t.data,this.form.patchValue({type:t.data.type,nom:t.data.nom,prenom:t.data.prenom,telephone:t.data.telephone,pays:t.data.pays,ville:t.data.ville,code_postal:t.data.code_postal,rue:t.data.rue,numero_rue:t.data.numero_rue,numeroSecuriteSocial:t.data.numeroSecuriteSocial,sexe:t.data.sexe})},error:t=>{console.log("error ",t)}})}getUserConnected(){this.authService.currentUser().subscribe({next:t=>{this.userconnected=t.data.user,console.log("error log ",t.data.user)},error:t=>{console.log("error log ",t)}})}get getNbrPartenaires(){return this.userconnected?.partenaires.length}get nom(){return this.form.get("nom")}get prenom(){return this.form.get("prenom")}get ville(){return this.form.get("ville")}get villeResidence(){return this.form.get("villeResidence")}get telephone(){return this.form.get("telephone")}get rue(){return this.form.get("rue")}get sexe(){return this.form.get("sexe")}get type(){return this.form.get("type")}get pays(){return this.form.get("pays")}get code_postal(){return this.form.get("code_postal")}get numeroSecuriteSocial(){return this.form.get("numeroSecuriteSocial")}displayFileName(t,i){console.log("Nom du fichier :",t.target.files[0].name);const l=t.target.files[0];if(l){const s=new FileReader;s.onloadend=()=>{this.saveFile(s.result,i)},s.readAsDataURL(l)}}saveFile(t,i){this.fileService.create({image:t}).subscribe({next:l=>{1===i?(this.onUpdateProfile=!0,this.form.patchValue({profile:l.data.id})):2==i&&(this.onUpdateJustificatif=!0,this.form.patchValue({justificatif:l.data.id})),console.log("data ",l.data.id)},error:l=>{console.error("file upload error:",l)}})}onSubmit(){let t=this.form.getRawValue();this.loading=!0,this.ptService.update(this.partenaireId,t).subscribe({next:i=>{this.errorMessage="",console.log("data ",i.data),this.loading=!1,i.data.errors?this.errorMessage="Une erreur est survenue":this.router.navigateByUrl("/partenaire/list/"+this.userId)},error:i=>{this.loading=!1,this.errorMessage="Une erreur est survenue",console.log("error ",i)}})}setupSecuritySocilaValidation(){this.numeroSecuriteSocial?.valid&&this.authService.verifInfos({numeroSecuriteSocial:this.numeroSecuriteSocial?.value},"verifNumeroSocial").subscribe(i=>{this.verifSecure=403===i.statusCode?"Le num\xe9ro de s\xe9curit\xe9 social existe d\xe9j\xe0.":""},i=>{console.error("Erreur lors de la validation de l'e-mail:",i),this.verifSecure="Le num\xe9ro de s\xe9curit\xe9 social existe d\xe9j\xe0."})}onChangeTelephone(){this.telephone?.valid&&this.authService.verifInfos({telephone:this.telephone?.value},"verifTelephone").subscribe(i=>{403===i.statusCode?this.verifSecure="Le num\xe9ro existe d\xe9j\xe0.":this.verifTel=""},i=>{console.error("Erreur lors de la validation de l'e-mail:",i),this.verifTel="Le num\xe9ro de t\xe9l\xe9hone  \xe9xiste d\xe9j\xe0."})}validateInput(t){/^\d+$/.test(t.key)||t.preventDefault()}static#e=this.\u0275fac=function(i){return new(i||r)(e.Y36(m.g),e.Y36(_.I),e.Y36(f.e),e.Y36(d.F0),e.Y36(o.qu),e.Y36(d.gz))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-update"]],decls:83,vars:15,consts:[[1,"container-fluid","mybg-color","pb-5","mt-5","pt-5"],[1,"d-flex","justify-content-start","gap-5","gx-5","align-items-center"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/partenaire/list",2,"color","white"],["aria-current","page",1,"breadcrumb-item","active","text-white"],[1,"container","pl-2","pr-2","shadow","rounded-5",2,"max-height","500px","overflow-y","auto"],[1,"card","border-0"],[1,"card-body"],[1,"card-title","text-center"],[1,"row","g-3",3,"formGroup","submit"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"col-md-6"],["for","objectEmail",1,"form-label"],["type","text","id","nom","formControlName","nom","placeholder","nom",1,"form-control"],["class","text-danger",4,"ngIf"],["type","text","id","prneom","formControlName","prenom","placeholder","prenom",1,"form-control"],["for","recive",1,"form-label"],["id","type","placeholder","Selectionner","formControlName","type",1,"form-select"],["value","partenaires"],["value","enfants"],["for","sexe",1,"form-label"],["id","sexe","placeholder","Selectionner","formControlName","sexe",1,"form-select"],["value","homme"],["value","femme"],[1,"col-sm-6"],["for","telephone",1,"form-label"],["type","text","id","telephone","formControlName","telephone","maxlength","15","placeholder","t\xe9l\xe9phone",1,"form-control",3,"keypress","input"],["for","pays",1,"form-label"],["type","text","id","pays","formControlName","pays","placeholder","pays",1,"form-control"],[1,"col-sm-4"],["for","ville",1,"form-label"],["type","text","id","ville","formControlName","ville","placeholder","ville",1,"form-control"],["for","rue",1,"form-label"],["type","text","id","rue","formControlName","rue","placeholder","rue",1,"form-control"],["for","numeroSecuriteSocial",1,"form-label"],["type","text","id","numeroSecuriteSocial","formControlName","numeroSecuriteSocial","maxlength","13","placeholder","numeroSecuriteSocial",1,"form-control",3,"keypress"],["for","formFile",1,"form-label"],["type","file","formControlName","profile","id","profil",1,"form-control",3,"change"],["type","file","id","justificatif","formControlName","justificatif",1,"form-control",3,"change"],[1,"col-12","justify-content-end","mt-3"],["type","submit",1,"btn","mybg-color","float-end","btn-lg",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"text-danger"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"nav",2)(4,"ol",3)(5,"li",4)(6,"a",5),e._uU(7,"Partenaire"),e.qZA()(),e.TgZ(8,"li",6),e._uU(9,"Modifier"),e.qZA()()()()()(),e.TgZ(10,"div",7)(11,"div",8)(12,"div",9)(13,"h5",10),e._uU(14,"Modification partenaire "),e.qZA(),e.TgZ(15,"form",11),e.NdJ("submit",function(){return n.onSubmit()}),e.YNc(16,B,2,1,"div",12),e.TgZ(17,"div",13)(18,"label",14),e._uU(19,"Nom"),e.qZA(),e._UZ(20,"input",15),e.YNc(21,G,2,0,"div",16),e.qZA(),e.TgZ(22,"div",13)(23,"label",14),e._uU(24,"Pr\xe9nom"),e.qZA(),e._UZ(25,"input",17),e.YNc(26,z,2,0,"div",16),e.qZA(),e.TgZ(27,"div",13)(28,"label",18),e._uU(29,"Type"),e.qZA(),e.TgZ(30,"select",19)(31,"option",20),e._uU(32,"Partenaire"),e.qZA(),e.TgZ(33,"option",21),e._uU(34,"Enfant"),e.qZA()(),e.YNc(35,$,2,0,"div",16),e.qZA(),e.TgZ(36,"div",13)(37,"label",22),e._uU(38,"Sexe"),e.qZA(),e.TgZ(39,"select",23)(40,"option",24),e._uU(41,"Homme"),e.qZA(),e.TgZ(42,"option",25),e._uU(43,"Femme"),e.qZA()(),e.YNc(44,X,2,0,"div",16),e.qZA(),e.TgZ(45,"div",26)(46,"label",27),e._uU(47,"T\xe9l\xe9phone"),e.qZA(),e.TgZ(48,"input",28),e.NdJ("keypress",function(s){return n.validateInput(s)})("input",function(){return n.onChangeTelephone()}),e.qZA(),e.YNc(49,W,2,0,"div",16),e.YNc(50,ee,2,1,"div",16),e.qZA(),e.TgZ(51,"div",26)(52,"label",29),e._uU(53,"Pays"),e.qZA(),e._UZ(54,"input",30),e.YNc(55,te,2,0,"div",16),e.qZA(),e.TgZ(56,"div",31)(57,"label",32),e._uU(58,"Ville"),e.qZA(),e._UZ(59,"input",33),e.YNc(60,re,2,0,"div",16),e.qZA(),e.TgZ(61,"div",31)(62,"label",34),e._uU(63,"Rue"),e.qZA(),e._UZ(64,"input",35),e.YNc(65,ne,2,0,"div",16),e.qZA(),e.TgZ(66,"div",31)(67,"label",36),e._uU(68,"Num\xe9ro s\xe9curit\xe9 sociale"),e.qZA(),e.TgZ(69,"input",37),e.NdJ("keypress",function(s){return n.validateInput(s)}),e.qZA(),e.YNc(70,ie,2,0,"div",16),e.qZA(),e.TgZ(71,"div",13)(72,"label",38),e._uU(73,"Profil"),e.qZA(),e.TgZ(74,"input",39),e.NdJ("change",function(s){return n.displayFileName(s,1)}),e.qZA()(),e.TgZ(75,"div",13)(76,"label",38),e._uU(77,"Justificatif"),e.qZA(),e.TgZ(78,"input",40),e.NdJ("change",function(s){return n.displayFileName(s,2)}),e.qZA()(),e.TgZ(79,"div",41)(80,"button",42),e.YNc(81,oe,1,0,"span",43),e.YNc(82,le,2,0,"span",44),e.qZA()()()()()()),2&i&&(e.xp6(15),e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("ngIf",n.errorMessage),e.xp6(5),e.Q6J("ngIf",(null==n.nom?null:n.nom.invalid)&&((null==n.nom?null:n.nom.dirty)||(null==n.nom?null:n.nom.touched))),e.xp6(5),e.Q6J("ngIf",(null==n.prenom?null:n.prenom.invalid)&&((null==n.prenom?null:n.prenom.dirty)||(null==n.prenom?null:n.prenom.touched))),e.xp6(9),e.Q6J("ngIf",(null==n.type?null:n.type.invalid)&&((null==n.type?null:n.type.dirty)||(null==n.type?null:n.type.touched))),e.xp6(9),e.Q6J("ngIf",(null==n.sexe?null:n.sexe.invalid)&&((null==n.sexe?null:n.sexe.dirty)||(null==n.sexe?null:n.sexe.touched))),e.xp6(5),e.Q6J("ngIf",(null==n.telephone?null:n.telephone.invalid)&&((null==n.telephone?null:n.telephone.dirty)||(null==n.telephone?null:n.telephone.touched))),e.xp6(1),e.Q6J("ngIf",n.verifTel),e.xp6(5),e.Q6J("ngIf",(null==n.pays?null:n.pays.invalid)&&((null==n.pays?null:n.pays.dirty)||(null==n.pays?null:n.pays.touched))),e.xp6(5),e.Q6J("ngIf",(null==n.ville?null:n.ville.invalid)&&((null==n.ville?null:n.ville.dirty)||(null==n.ville?null:n.ville.touched))),e.xp6(5),e.Q6J("ngIf",(null==n.rue?null:n.rue.invalid)&&((null==n.rue?null:n.rue.dirty)||(null==n.rue?null:n.rue.touched))),e.xp6(5),e.Q6J("ngIf",(null==n.numeroSecuriteSocial?null:n.numeroSecuriteSocial.invalid)&&((null==n.numeroSecuriteSocial?null:n.numeroSecuriteSocial.dirty)||(null==n.numeroSecuriteSocial?null:n.numeroSecuriteSocial.touched))),e.xp6(10),e.Q6J("disabled",n.loading||n.form.invalid),e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading))},dependencies:[p.O5,d.rH,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.nD,o.sg,o.u],styles:[".mybg-color[_ngcontent-%COMP%]{background-color:#0f7231;color:#fff}"]})}return r})()}]}];let se=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275mod=e.oAB({type:r});static#r=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(ae),d.Bz]})}return r})(),ue=(()=>{class r{static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275mod=e.oAB({type:r});static#r=this.\u0275inj=e.cJS({imports:[p.ez,se,o.UX]})}return r})()}}]);